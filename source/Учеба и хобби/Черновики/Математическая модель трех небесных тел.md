---
icon: LiSatellite
---
$$
\begin{cases}
x''=x+2y'-M\frac{x+m}{R_{1}}-m \frac{x-M}{R_{2}} \\
y''=y-2x'-M \frac{y}{R_{1}}-m \frac{y}{R_{2}}
\end{cases}\implies
\begin{cases}
v_{1}'=x+2v_{2}-M\frac{x+m}{R_{1}}-m \frac{x-M}{R_{2}} \\
v_{2}'=y-2v_{1}-M \frac{y}{R_{1}}-m \frac{y}{R_{2}} \\
x'=v_{1} \\
y'=v_{2}
\end{cases}
$$
Задача Коши:
$$
\begin{cases}
v_{1}(0)=0 \\
v_{2}(0)=−2.031732629557337 \\
x(0)=0.994 \\
y(0)=0 \\
\end{cases}
$$

Где:
$$
\begin{align} \\
m&=0.012277471 \\
M&=1-m=0.987722529 \\
T&=11.124340337 \\
R_{1}&=((x+m)^{2}+y^{2})^{3/2} \\
R_{2}&=((x-M)^{2}+y^{2})^{3/2}
\end{align}
$$

Я нашел интересную формулу для вычисления ошибки метода Мерсона:
$$
\varepsilon=\frac{1}{30}|-k_{1}+4k_{3}+k_{4}-k_{5}|
$$

План для модернизации:
1. Изучить вычисление ошибки в методе Мерсона (локальная $O(h^5)$, глобальная — $O(h^4)$)
> Есть [теоретическая оценка](https://astro.tsu.ru/ChIntODY/text/3_5_1.html), есть через ричардсон-экстраполяцию: $\varepsilon \approx \frac{y_{\frac{h}{2}}-y_{h}}{2^{p}-1}$
2. Добавить отрисовку с `matplotlibcpp.h`
3. Оптимизировать метод Мерсона с `avx`
4. Переписать задачу в виде классов для того, чтобы можно было удобно работать с несколькими сущностями
5. Сделать нормальный адаптивный шаг с учетом ошибки из пункта (1)
6. Сделать возможность работать с несколькими объектами
7. Разработать логику для расчета столкновений
