---
icon: LiAccessibility
---
На практике часто возникают системы из 3-х диагональных матриц
$$
\begin{cases}
C_{0}y_{0}-b_{0}y_{1}=f_{0},~i=0 \\
-a_{i}y_{i-1}+cy_{i}-b_{i}y_{i+1}=f_{i}, ~i = 1, 2,\dots, n - 1 \\
-a_{n-1}y_{n-1} + c_{n}y_{n}=f_{n}
\end{cases}
$$

Тут у нас $Ay=f$, $y=(y_{0}, y_{1}, \dots, y_{n})$, $f=f(f_{0}, f_{1}, \dots, f_{ n })$
$$
\mathcal{A}=\begin{pmatrix}
c_{0} & -b_{0} & 0 & 0 & \dots & 0 & 0 & 0 & 0 \\
-a_{1} & c_{1} & -b_{1} & 0 & \dots & 0 & 0 & 0 & 0  \\
0 & -a_{2} & c_{2} & -b_{2} & \dots & 0 & 0 & 0 & 0 \\
0 & 0 & -a_{3} & c_{3} & \dots & 0 & 0 & 0 & 0  \\
\dots & \dots & \dots & \dots & \dots & \dots & \dots & \dots & \dots &  \\
0 & 0 & 0 & 0 & \dots & c_{n-3} & -b_{n-3} & 0 & 0 \\
0 & 0 & 0 & 0 & \dots & -a_{n-2} & c_{n-2} & -b_{n-2}  & 0 \\
0 & 0 & 0 & 0 & \dots & 0 & -a_{n-1} & c_{n-1} & -b_{n-1} \\
0 & 0 & 0 & 0 & \dots & 0 & 0 & -a_{ n } & c_{ n }
\end{pmatrix}
$$

Построим метод прогонки на методе исключения переменных Гаусса
1. Для всех уравнений системы мы исключаем переменную $y_{0}$ из второй строки
2. Затем для $i=2, 3, \dots, n-1$ мы будем исключать переменную $y_{i-1}$
3. Так мы получим одно уравнение относительно $y_{n}$

## Подробнее
Положим для этого $\alpha_{0}=\frac{b_{0}}{c_{0}}$, $\beta_{0}=\frac{f_{0}}{c_{0}}$
Тогда:
$$
\begin{align}
y_{0}=-\alpha_{0}y_{1} & =\beta_{0} \\
-a_{1}y_{0}+c_{1}y_{1}-b_{1}y_{2} & =f_{1} \\
(c_{1}-\alpha_{1}a_{1})y_{1}-b_{1}y_{2} & =f_{1}+a_{1}\beta_{1} \\
y_{1}-\alpha_{2}y_{2} & = \beta_{2}
\end{align}
$$
Тут уже $\alpha_{2}=\frac{b_{1}}{c_{1}-\alpha_{1}a_{1}}$, $\beta_{2}=\frac{f_{1}+a_{1}\beta_{1}}{c_{1}-\alpha_{1}a_{1}}$
Заметим, что теперь система не зависит от $y_{0}$. Таким образом, мы получили укороченную версию системы

Так, приходим к системе:
$$
\begin{cases}
y_{1}-\alpha_{2}y_{2}=\beta_{2} \\
\dots \\
-a_{ i }y_{i-1}+c_{ i }y_{i}-b_{i}y_{i+1}=f_{i} \\
\dots \\
-a_{n}y_{n-1}+c_{n}y_{n}=f_{n}
\end{cases},~i=\overline{ 2,n-1 }
$$

Решив эту систему, можно найти $y_{0}$
Так, мы получаем рекурсивную формулу. Обобщим ее:
$$
\begin{cases}
\alpha_{i+1}=\frac{b_{i}}{c_{i}-\alpha_{i}a_{i}}, & i=\overline{ 2,n-1 }\\
\beta_{i+1}=\frac{f_{i}+\alpha _{i}\beta _{i}}{c_{i}-\alpha _{i}a_{i}}, & i=\overline{ 2,n-1 } \\
\beta_{n+1}=\frac{f_{n}+a_{n}\beta _{n}}{c_{n}-\alpha _{n}a_{n}} \\
y_{i}=\alpha_{i+1}y_{i+1}+\beta_{i+1} \\
\alpha_{1}=\frac{b_{0}}{c_{0}}  & \small{\text{Мы сменили индекс 0 на 1 для удобства}}\\
\beta_{1}=\frac{f_{0}}{c_{0}} \\
y_{0}=\alpha_{1}y_{1}+\beta_{1} \\
y_{n}=\beta_{n+1}
\end{cases}
$$

Итак, задача сводится к нахождению прогоночных коэффициентов $\alpha _{i}$ и $\beta _{i}$
> [!tip] Эти формулы для решения методом Гаусса получил специальное название — метод прогонки

## Условия устойчивости метода прогонки
Из формул прогоночных коэффициентов очевидно, что 
$$
\begin{cases}
c_{0}\neq_{0} \\
c_{i}-\alpha _{i}a_{i}\neq_{0} \forall i
\end{cases}
$$
Данное условие эквивалентно диагональному преобладанию матрицы $\mathcal{A}$, т.е. главная диагональ по модулю больше суммы модулей элементов на остальных диагоналях:
$$
\begin{cases}
|c_{0}|>|b_{0}| \\
|c_{i}|>|a_{i}|+|b_{i}|, \forall i \\
|c_{n}|>|a_{n}|
\end{cases}
$$

## Задача
Для 09-321:
$$
n=\begin{cases}
10 \\
20
\end{cases}
$$

Для 09-322:
$$
n=\begin{cases}
10 \\
30
\end{cases}
$$

---

$$
\varepsilon=h^{3}
$$
Также нужно дополнить систему до $y=(0, y_{1}, y_{2},\dots,y_{n-1},0)$
Нужно составить таблицу:

| $x_{i}$ | $y_{i}$ | $u(x_{i})$ | $\mod(y_{i}-u(x_{i}))$ |
| ------- | ------- | ---------- | ---------------------- |
|         |         |            |                        |

## Вторая часть хз что там
$$
\begin{cases}
y_{0} & =0 \\
(a_{1}+a_{2}+h^{2}g_{1})y_{1}-a_{2}y_{2} & =f_{1}h^{2} \\
\dots & \dots \\
-a_{i}y_{i-1}+(a_{i}+a_{i+1}+h^{2}g_{i})y_{i}-a_{i+1}y_{i+1} & =f_{i}h^{2} \\
\dots & \dots \\
(a_{n-1}+a_{n}+h^{2}g_{n-1})y_{n-1}-a_{n-1}y_{n-2} & =f_{n-1}h^{2} \\
y_{n} & =0
\end{cases}
$$
$$
y=\begin{pmatrix}
0 \\
y_{1} \\
y_{2} \\
\dots \\
y_{n-1} \\
0
\end{pmatrix}
$$
$$
\begin{cases}
a_{i} & = p(ih) \\
g_{i} & =q(ih) \\
f_{i} & =f(ih) \\
\end{cases}
$$
$$
\begin{cases}
p(x)  & = 1+x^{\gamma} \\
q(x)  & = x + 1 \\
u(x)  & = x^{\alpha}(1-x)^{\beta} \\
f(x) & = -(p(x)u'(x))'+q(x)u(x),~\boxed{ h=\frac{1}{n},~n=10,~20 } \\
x \in [0,~1]
\end{cases}
$$

# Итерационные методы
$$
Ax=b
$$
Диагональные элементы матрицы $A$ отличны от нуля. Разрешаем относительно переменной, стоящей на главной диагонали:
$$
x_{i}=\frac{1}{a_{ii}} \left( b_{i}-\sum\limits_{j=1,~j\neq i}^{n}a_{ij}x_{j} \right)
$$

## Для итерационных методов метод Якоби:
$$
\begin{cases}
x_{i}^{k+1}=\frac{1}{a_{ii}} \left( b_{i}-\sum\limits_{j=1,~j\neq i}^{n}a_{ij}x_{j} \right) \\
x^{0}=(x_{1}^{0},\dots,x_{n}^{0})^{T} \\
x_{i}^{0} =\text{rand} \\
Ax^{k}=b^{k} \text{ пока не } |b^{k}-b| > \varepsilon
\end{cases}
$$

Для нашей 3-х диагональной матрицы:
$$
\begin{cases}
y_{i}^{k+1}=\frac{a_{i}}{a_{i}+a_{i+1}+h^{2}g_{i}}(y_{i-1}^{k}+y_{i+1}^{k}+f_{i}h^{2}) \\
y_{i}^{0}=0, i=\overline{ 1,n-1 } \\
y_{0}^{k}=y_{n}^{k}~\forall k \\
r^{k}=Ay^{k}-f
\end{cases}
$$
Считаем пока $\underset{ i }{ \max }r_{i}^{k}\leq\varepsilon$

## Метод Зейделя
Просто используем уже посчитанные $y_{i}^{k}$:
$$
\begin{cases}
y_{i}^{k+1}=\frac{a_{i}}{a_{i}+a_{i+1}+h^{2}g_{i}}(\overbrace{ y_{i-1}^{k+1} }^{ \text{Вот тут} }+y_{i+1}^{k}+f_{i}h^{2}) \\
y_{i}^{0}=0, i=\overline{ 1,n-1 } \\
y_{0}^{k}=y_{n}^{k}~\forall k \\
r^{k}=Ay^{k}-f
\end{cases}
$$

## Метод релаксации
Если $\omega \in (1,~2)$ — метод верхней релаксации, если $\omega \in (0,~1)$ — нижней
Параметр $\omega$ подбираем экспериментально 
Прикол в том, что все так же, кроме 
$$
y_{i}^{k+1}=(1-\omega)y_{i}^{k}+\omega \cdot I
$$

## Метод наискорейшего спуска
Имеем:
$$
y_{i}^{k+1}=y_{i}^{k}-\tau r_{i}^{k},~i=\overline{ 1,n-1 }
$$

Где $r_{i}^{k}$ — вектор невязки
$$
\begin{cases}
r_{k}=Ay^{k}-f \\
r_{i}^{k}=-a_{i}y_{i-1}^{k}+(a_{i}+a_{i+1}+h^{2}g_{i})y_{i}^{k}-a_{i+1}y_{i+1}^{k}-f_{i}h^{2} \\
\tau=\frac{(r^k,r^k)}{(Ar^{k},r^{k})} \\
(Ar^{k})_{i}=-a_{i}r_{i-1}^{k}+(a_{i}+a_{i+1}+h^{2}g_{i})r_{i}^{k} - a_{i+1}r_{i+1}^{k}
\end{cases}
$$
## Шаблон таблицы
| $i$ | $y_{i}^{\text{прогонки}}$ | $y_{i}^{\text{зейделя}}$ | $mod(y_{i}-y_{i}^{\text{зейделя}})$ | $k$    |
| --- | ------------------------- | ------------------------ | ----------------------------------- | --- |

| студенты            | $\alpha$ | $\beta$ | $\gamma$ | Extra |
| ------------------- |:--------:|:-------:|:--------:|:-----:|
| Айдашев Наиль       |    3     |    2    |    2     |       |
| Ашуров Темирлан     |    6     |    6    |    6     |       |
| Бакиров Карим       |    3     |    1    |    1     |       |
| Бикмансуров Даниил  |    1     |    3    |    1     |       |
| Быданов Марат       |    1     |    3    |    3     |       |
| Гарифуллин Амир     |    5     |    5    |    5     |       |
| Замилов Тимур       |    1     |    3    |    2     |       |
| Калимуллина Гульназ |    1     |    2    |    1     |       |
| Кириллова Дарья     |    1     |    1    |    1     |       |
| Лещенко Илья        |    3     |    5    |    2     |  −5   |
| Логинова Диана      |    2     |    1    |    1     |       |
| Нурутдинов Игорь    |    3     |    2    |    1     |       |
| Сашикова Елизавета  |    1     |    2    |    2     |       |
| Степанова Анастасия |    2     |    2    |    1     |       |
| Суюндуков Гайсар    |    4     |    1    |    1     |       |
| Уфаев Евгений       |    3     |    3    |    3     |       |
| Чуркин Степан       |    2     |    1    |    2     |       |
| Шабардин Егор       |    1     |    2    |    3     |       |
| Шакирова Камиля     |    1     |    1    |    2     |       |
| Шолохов Владислав   |    2     |    2    |    2     |       |
